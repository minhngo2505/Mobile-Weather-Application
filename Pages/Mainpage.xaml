<?xml version="1.0" encoding="UTF-8" ?>
<ContentPage
    x:Class="MauiApp1.Pages.Mainpage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    BackgroundColor="{DynamicResource PageBackgroundColor}">

    <Grid RowDefinitions="Auto,*,Auto">

        <!-- ðŸ” SEARCH -->
        <Border Grid.Row="0" Margin="15"
                Stroke="{DynamicResource SecondaryTextColor}" StrokeThickness="1"
                BackgroundColor="{DynamicResource PrimaryColor}" Padding="8"
                StrokeShape="RoundRectangle 15">
            <SearchBar x:Name="CitySearchBar"
                       Placeholder="Search city..."
                       TextColor="{DynamicResource PrimaryTextColor}"
                       PlaceholderColor="{DynamicResource SecondaryTextColor}"
                       SearchButtonPressed="OnSearchPressed"
                       BackgroundColor="Transparent"
                       FontSize="{DynamicResource AppFontSize}"/>
        </Border>


        <!-- MAIN CONTENT -->
        <ScrollView Grid.Row="1">
            <VerticalStackLayout Spacing="22" Padding="15">

                <!-- ðŸŒ¤ CURRENT WEATHER -->
                <VerticalStackLayout Spacing="8" Padding="10">
                    <Label x:Name="CityLabel"
                           Text="Perth, AU"
                           FontSize="34"
                           TextColor="{DynamicResource PrimaryTextColor}"
                           HorizontalOptions="Center"
                           FontAttributes="Bold"/>

                    <Label x:Name="TempLabel"
                           Text="21Â°C | Clear"
                           FontSize="26"
                           TextColor="{DynamicResource PrimaryTextColor}"
                           HorizontalOptions="Center"/>

                    <Image x:Name="WeatherImage"
                           WidthRequest="120"
                           HeightRequest="120"
                           Aspect="AspectFit"
                           HorizontalOptions="Center"/>
                </VerticalStackLayout>


                <!-- ðŸŒ¡ DETAILS GRID -->
                <Grid ColumnDefinitions="*,*"
                      RowDefinitions="Auto,Auto"
                      ColumnSpacing="12"
                      RowSpacing="12">

                    <!-- Feels like -->
                    <Border Background="{DynamicResource PrimaryColor}" Stroke="{DynamicResource SecondaryTextColor}" StrokeShape="RoundRectangle 12">
                        <VerticalStackLayout Padding="12">
                            <Label Text="Feels Like" TextColor="{DynamicResource PrimaryTextColor}" />
                            <Label x:Name="FeelsLikeLabel" Text="20Â°C" TextColor="{DynamicResource SecondaryTextColor}" FontSize="{DynamicResource AppFontSize}"/>
                        </VerticalStackLayout>
                    </Border>

                    <!-- Humidity -->
                    <Border Background="{DynamicResource PrimaryColor}" Stroke="{DynamicResource SecondaryTextColor}" StrokeShape="RoundRectangle 12" Grid.Column="1">
                        <VerticalStackLayout Padding="12">
                            <Label Text="Humidity" TextColor="{DynamicResource PrimaryTextColor}" />
                            <Label x:Name="HumidityLabel" Text="60%" TextColor="{DynamicResource SecondaryTextColor}" FontSize="{DynamicResource AppFontSize}"/>
                        </VerticalStackLayout>
                    </Border>

                    <!-- UV -->
                    <Border Background="{DynamicResource PrimaryColor}" Stroke="{DynamicResource SecondaryTextColor}" StrokeShape="RoundRectangle 12" Grid.Row="1">
                        <VerticalStackLayout Padding="12">
                            <Label Text="UV Index" TextColor="{DynamicResource PrimaryTextColor}" />
                            <Label x:Name="UVLabel" Text="5 Moderate" TextColor="{DynamicResource SecondaryTextColor}" FontSize="{DynamicResource AppFontSize}"/>
                        </VerticalStackLayout>
                    </Border>

                    <!-- Wind -->
                    <Border Background="{DynamicResource PrimaryColor}" Stroke="{DynamicResource SecondaryTextColor}" StrokeShape="RoundRectangle 12" Grid.Row="1" Grid.Column="1">
                        <VerticalStackLayout Padding="12">
                            <Label Text="Wind" TextColor="{DynamicResource PrimaryTextColor}" />
                            <Label x:Name="WindLabel" Text="12 km/h NW" TextColor="{DynamicResource SecondaryTextColor}" FontSize="{DynamicResource AppFontSize}"/>
                        </VerticalStackLayout>
                    </Border>

                </Grid>


                <!-- HOURLY FORECAST -->
                <Border Stroke="{DynamicResource SecondaryTextColor}" StrokeThickness="1" StrokeShape="RoundRectangle 15">
                    <VerticalStackLayout Padding="10" Spacing="10">

                        <Label Text="Hourly Forecast"
                                FontAttributes="Bold"
                                FontSize="20" 
                                TextColor="{DynamicResource PrimaryTextColor}"/>

                        <CollectionView x:Name="HourlyForecastView"
                            ItemsLayout="HorizontalList"
                            HeightRequest="120"
                            HorizontalScrollBarVisibility="Never">

                            <CollectionView.ItemTemplate>
                                <DataTemplate>
                                    <Border Stroke="{DynamicResource SecondaryTextColor}"  StrokeThickness="1" StrokeShape="RoundRectangle 10" Padding="8"
                                WidthRequest="80"
                                Margin="5">

                                        <VerticalStackLayout Spacing="5" HorizontalOptions="Center">

                                            <Label Text="{Binding Time}"
                                        FontSize="14"
                                        HorizontalOptions="Center"
                                        TextColor="{DynamicResource PrimaryTextColor}" />

                                            <Image Source="{Binding IconUrl}"
                                        HeightRequest="40"
                                        HorizontalOptions="Center" />

                                            <Label Text="{Binding TempC, StringFormat='{}{0}Â°C'}" 
                                        FontSize="14"
                                        HorizontalOptions="Center"
                                        TextColor="{DynamicResource PrimaryTextColor}" />

                                        </VerticalStackLayout>

                                    </Border>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>
                    </VerticalStackLayout>
                </Border>


                <!-- 10 DAY FORECAST -->
                <!-- ðŸ“… 10-DAY FORECAST -->
                <!-- in fact just 3 days forecast appears because that meet the free limit , we can update the VIP package to get full version of 10 days forecast -->
                <Border  Stroke="{DynamicResource SecondaryTextColor}" StrokeThickness="1" StrokeShape="RoundRectangle 15">
                    <VerticalStackLayout Padding="10" Spacing="10">

                        <Label Text="10-Day Forecast"
                               FontAttributes="Bold"
                               FontSize="20"
                               TextColor="{DynamicResource PrimaryTextColor}"/>

                        <CollectionView x:Name="TenDayForecast"
                            HeightRequest="400">
                            <CollectionView.ItemTemplate>
                                <DataTemplate>
                                    <Border Stroke="{DynamicResource SecondaryTextColor}"
                                            StrokeShape="RoundRectangle 10"
                                            Padding="10"
                                            Margin="5">
                                        <Grid ColumnDefinitions="*,Auto,Auto,Auto" ColumnSpacing="15">

                                            <!-- Day -->
                                            <Label Text="{Binding Day}" 
                                                   FontAttributes="Bold" 
                                                   Grid.Column="0"
                                                   TextColor="{DynamicResource PrimaryTextColor}"/>

                                            <!-- Icon -->
                                            <Image Source="{Binding IconUrl}"
                                       HeightRequest="30"
                                       Grid.Column="1"/>

                                            <!-- Temps -->
                                            <Label  Text="{Binding MaxTemp , StringFormat='{}{0}Â°C'}" 
                                       TextColor="{DynamicResource PrimaryTextColor}"
                                       Grid.Column="2"/>

                                            <Label Text="{Binding MinTemp , StringFormat='{}{0}Â°C'}"
                                       TextColor="{DynamicResource PrimaryTextColor}"
                                       Grid.Column="3"/>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>

                    </VerticalStackLayout>
                    
                </Border>
                <Button 
                        x:Name="MapButton"
                        Text="Open Weather Map"
                        ImageSource="map.png"
                        BackgroundColor="{DynamicResource PrimaryColor}"
                        TextColor="{DynamicResource PrimaryTextColor}"
                        CornerRadius="25"
                        HeightRequest="55"
                        WidthRequest="220"
                        HorizontalOptions="Center"
                        Padding="10"
                        Clicked="OnMapButtonClicked"
                        Margin="0,10,0,25">
                    <Button.Shadow>
                        <Shadow Brush="#00000055" Opacity="0.4" Radius="8" />
                    </Button.Shadow>
                </Button>
            </VerticalStackLayout>
        </ScrollView>
    </Grid>
</ContentPage>
